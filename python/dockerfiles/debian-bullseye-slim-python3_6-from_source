# NOTE!
# The COPY command will only work properly if
# the command using this Dockerfile to build the Docker image
# is called from the
# save-thread-result/python directory
# and will NOT work if called from the
# save-thread-result/python/tests directory
# or the
# save-thread-result directory


FROM debian:bullseye-20231120-slim AS base

RUN apt-get -y update; apt-get install \
  curl \
  gcc \
  make \
  gdb lcov pkg-config \
  libbz2-dev libffi-dev libgdbm-dev libgdbm-compat-dev liblzma-dev \
  libncurses5-dev libreadline6-dev libsqlite3-dev libssl-dev \
  lzma lzma-dev tk-dev uuid-dev zlib1g-dev -y \
  && curl -SL https://www.python.org/ftp/python/3.6.15/Python-3.6.15.tgz | tar -xzvf - \
  && cd Python-3.6.15 && ./configure && make && make altinstall

FROM debian:bullseye-20231120-slim AS final

COPY --from=base /usr/local/ /usr/local/

COPY . ./save_thread_result/python

CMD ["python3.6", "save_thread_result/python/dummy_example.py"]
